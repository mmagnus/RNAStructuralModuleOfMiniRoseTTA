import torch
import numpy as np

num2aa=[
    '  A','  C','  G','  U', '  N',
]

aa2num= {x:i for i,x in enumerate(num2aa)}

# NAATOKENS = 20+2+10 # 20 AAs, UNK, MASK, 8 NAs
# MASKINDEX = 21  # protein mask
NAATOKENS = 4+1 # 4NAs, UNK

# NHEAVY = 23
# NTOTAL = 36
# NPROTAAS = 22 # include UNK/MAS

NHEAVY = 23 # C,O,N,P
NTOTAL = 34 # with H

# # internal coords
# NPROTTORS = 7
# NPROTANGS = 3
# NNATORS = 10
# NTOTALTORS = NPROTTORS+NNATORS
# NTOTALDOFS = NTOTALTORS+NPROTANGS

NNATORS = 6+3+1 # 6 backbone, 3 sugar ring, 1 sugar-base
NTOTALTORS = NNATORS
NTOTALDOFS = NNATORS

# full sc atom representation
aa2long=[
    (" OP1"," P  "," OP2"," O5'"," C5'"," C4'"," O4'"," C3'"," O3'"," C1'"," C2'"," O2'"," N1 "," C2 "," N3 "," C4 "," C5 "," C6 "," N6 "," N7 "," C8 "," N9 ",  None," H5'","H5''"," H4'"," H3'"," H2'","HO2'"," H1'"," H2 "," H61"," H62"," H8 "), #27   A
    (" OP1"," P  "," OP2"," O5'"," C5'"," C4'"," O4'"," C3'"," O3'"," C1'"," C2'"," O2'"," N1 "," C2 "," O2 "," N3 "," C4 "," N4 "," C5 "," C6 ",  None,  None,  None," H5'","H5''"," H4'"," H3'"," H2'","HO2'"," H1'"," H42"," H41"," H5 "," H6 "), #28   C
    (" OP1"," P  "," OP2"," O5'"," C5'"," C4'"," O4'"," C3'"," O3'"," C1'"," C2'"," O2'"," N1 "," C2 "," N2 "," N3 "," C4 "," C5 "," C6 "," O6 "," N7 "," C8 "," N9 "," H5'","H5''"," H4'"," H3'"," H2'","HO2'"," H1'"," H1 "," H22"," H21"," H8 "), #29   G
    (" OP1"," P  "," OP2"," O5'"," C5'"," C4'"," O4'"," C3'"," O3'"," C1'"," C2'"," O2'"," N1 "," C2 "," O2 "," N3 "," C4 "," O4 "," C5 "," C6 ",  None,  None,  None," H5'","H5''"," H4'"," H3'"," H2'","HO2'"," H1'"," H3 "," H5 "," H6 ",  None), #30   U
    (" OP1"," P  "," OP2"," O5'"," C5'"," C4'"," O4'"," C3'"," O3'"," C1'"," C2'"," O2'",  None,  None,  None,  None,  None,  None,  None,  None,  None,  None,  None," H5'","H5''"," H4'"," H3'"," H2'","HO2'"," H1'",  None,  None,  None,  None), #31  RX (unk RNA)
]


# build the "alternate" sc mapping
aa2longalt=[
    (" OP1"," P  "," OP2"," O5'"," C5'"," C4'"," O4'"," C3'"," O3'"," C1'"," C2'"," O2'"," N1 "," C2 "," N3 "," C4 "," C5 "," C6 "," N6 "," N7 "," C8 "," N9 ",  None," H5'","H5''"," H4'"," H3'"," H2'","HO2'"," H1'"," H2 "," H61"," H62"," H8 "), #   A
    (" OP1"," P  "," OP2"," O5'"," C5'"," C4'"," O4'"," C3'"," O3'"," C1'"," C2'"," O2'"," N1 "," C2 "," O2 "," N3 "," C4 "," N4 "," C5 "," C6 ",  None,  None,  None," H5'","H5''"," H4'"," H3'"," H2'","HO2'"," H1'"," H42"," H41"," H5 "," H6 "), #   C
    (" OP1"," P  "," OP2"," O5'"," C5'"," C4'"," O4'"," C3'"," O3'"," C1'"," C2'"," O2'"," N1 "," C2 "," N2 "," N3 "," C4 "," C5 "," C6 "," O6 "," N7 "," C8 "," N9 "," H5'","H5''"," H4'"," H3'"," H2'","HO2'"," H1'"," H1 "," H22"," H21"," H8 "), #   G
    (" OP1"," P  "," OP2"," O5'"," C5'"," C4'"," O4'"," C3'"," O3'"," C1'"," C2'"," O2'"," N1 "," C2 "," O2 "," N3 "," C4 "," O4 "," C5 "," C6 ",  None,  None,  None," H5'","H5''"," H4'"," H3'"," H2'","HO2'"," H1'"," H3 "," H5 "," H6 ",  None), #   U
    (" OP1"," P  "," OP2"," O5'"," C5'"," C4'"," O4'"," C3'"," O3'"," C1'"," C2'"," O2'",  None,  None,  None,  None,  None,  None,  None,  None,  None,  None,  None," H5'","H5''"," H4'"," H3'"," H2'","HO2'"," H1'",  None,  None,  None,  None), #  RX (unk RNA)
]

aabonds=[
    ((" P  "," OP2"),(" P  "," OP1"),(" P  "," O5'"),(" O5'"," C5'"),(" C5'"," C4'"),(" C5'"," H5'"),(" C5'","H5''"),(" C4'"," O4'"),(" C4'"," C3'"),(" C4'"," H4'"),(" O4'"," C1'"),(" C3'"," O3'"),(" C3'"," C2'"),(" C3'"," H3'"),(" C2'"," C1'"),(" C2'"," O2'"),(" C2'"," H2'"),(" O2'","HO2'"),(" C1'"," N9 "),(" C1'"," H1'"),(" N1 "," C2 "),(" N1 "," C6 "),(" C2 "," N3 "),(" C2 "," H2 "),(" N3 "," C4 "),(" C4 "," C5 "),(" C4 "," N9 "),(" C5 "," C6 "),(" C5 "," N7 "),(" C6 "," N6 "),(" N6 "," H61"),(" N6 "," H62"),(" N7 "," C8 "),(" C8 "," N9 "),(" C8 "," H8 ")), # A
    ((" P  "," OP2"),(" P  "," OP1"),(" P  "," O5'"),(" O5'"," C5'"),(" C5'"," C4'"),(" C5'"," H5'"),(" C5'","H5''"),(" C4'"," O4'"),(" C4'"," C3'"),(" C4'"," H4'"),(" O4'"," C1'"),(" C3'"," O3'"),(" C3'"," C2'"),(" C3'"," H3'"),(" C2'"," C1'"),(" C2'"," O2'"),(" C2'"," H2'"),(" O2'","HO2'"),(" C1'"," N1 "),(" C1'"," H1'"),(" N1 "," C2 "),(" N1 "," C6 "),(" C2 "," O2 "),(" C2 "," N3 "),(" N3 "," C4 "),(" C4 "," N4 "),(" C4 "," C5 "),(" N4 "," H42"),(" N4 "," H41"),(" C5 "," C6 "),(" C5 "," H5 "),(" C6 "," H6 ")), # C
    ((" P  "," OP2"),(" P  "," OP1"),(" P  "," O5'"),(" O5'"," C5'"),(" C5'"," C4'"),(" C5'"," H5'"),(" C5'","H5''"),(" C4'"," O4'"),(" C4'"," C3'"),(" C4'"," H4'"),(" O4'"," C1'"),(" C3'"," O3'"),(" C3'"," C2'"),(" C3'"," H3'"),(" C2'"," C1'"),(" C2'"," O2'"),(" C2'"," H2'"),(" O2'","HO2'"),(" C1'"," N9 "),(" C1'"," H1'"),(" N1 "," C2 "),(" N1 "," C6 "),(" N1 "," H1 "),(" C2 "," N2 "),(" C2 "," N3 "),(" N2 "," H22"),(" N2 "," H21"),(" N3 "," C4 "),(" C4 "," C5 "),(" C4 "," N9 "),(" C5 "," C6 "),(" C5 "," N7 "),(" C6 "," O6 "),(" N7 "," C8 "),(" C8 "," N9 "),(" C8 "," H8 ")), # G
    ((" P  "," OP2"),(" P  "," OP1"),(" P  "," O5'"),(" O5'"," C5'"),(" C5'"," C4'"),(" C5'"," H5'"),(" C5'","H5''"),(" C4'"," O4'"),(" C4'"," C3'"),(" C4'"," H4'"),(" O4'"," C1'"),(" C3'"," O3'"),(" C3'"," C2'"),(" C3'"," H3'"),(" C2'"," C1'"),(" C2'"," O2'"),(" C2'"," H2'"),(" O2'","HO2'"),(" C1'"," N1 "),(" C1'"," H1'"),(" N1 "," C2 "),(" N1 "," C6 "),(" C2 "," O2 "),(" C2 "," N3 "),(" N3 "," C4 "),(" N3 "," H3 "),(" C4 "," O4 "),(" C4 "," C5 "),(" C5 "," C6 "),(" C5 "," H5 "),(" C6 "," H6 ")), # U
    ((" P  "," OP2"),(" P  "," OP1"),(" P  "," O5'"),(" O5'"," C5'"),(" C5'"," C4'"),(" C5'"," H5'"),(" C5'","H5''"),(" C4'"," O4'"),(" C4'"," C3'"),(" C4'"," H4'"),(" O4'"," C1'"),(" C3'"," O3'"),(" C3'"," C2'"),(" C3'"," H3'"),(" C2'"," C1'"),(" C2'"," O2'"),(" C2'"," H2'"),(" O2'","HO2'"),(" C1'"," H1'")), # RX
]

aa2type = [
    ("OOC","Phos", "OOC", "Oet2","CH2", "CH1", "Oet3","CH1", "Oet2","CH1", "CH2", "OH",  "Nhis","aroC","Nhis","aroC","aroC","aroC","NH2O","Nhis","aroC","Npro",  None,"Hapo","Hapo","Hapo","Hapo","Hapo","Hpol","Hapo","Haro","Hpol","Hpol","Haro"), # A
    ("OOC","Phos", "OOC", "Oet2","CH2", "CH1", "Oet3","CH1", "Oet2","CH1", "CH2", "OH",  "Npro","CObb","OCbb","Nhis","aroC","NH2O","aroC","aroC",  None,  None,  None,"Hapo","Hapo","Hapo","Hapo","Hapo","Hpol","Hapo","Hpol","Hpol","Haro","Haro"), # C
    ("OOC","Phos", "OOC", "Oet2","CH2", "CH1", "Oet3","CH1", "Oet2","CH1", "CH2", "OH",  "Ntrp","aroC","NH2O","Nhis","aroC","aroC","CObb","OCbb","Nhis","aroC","Npro","Hapo","Hapo","Hapo","Hapo","Hapo","Hpol","Hapo","Hpol","Hpol","Hpol","Haro"), # G
    ("OOC","Phos", "OOC", "Oet2","CH2", "CH1", "Oet3","CH1", "Oet2","CH1", "CH2", "OH",  "Npro","CObb","OCbb","Ntrp","CObb","OCbb","aroC","aroC",  None,  None,  None,"Hapo","Hapo","Hapo","Hapo","Hapo","Hpol","Hapo","Hpol","Hapo","Haro",  None), # U
    ("OOC","Phos", "OOC", "Oet2","CH2", "CH1", "Oet3","CH1", "Oet2","CH1", "CH2", "OH",    None,  None,  None,  None,  None,  None,  None,  None,  None,  None,  None,"Hapo","Hapo","Hapo","Hapo","Hapo","Hpol","Hapo",  None,  None,  None,  None), # RX (unk RNA)
]

aa2elt = [
    ("O","P","O","O","C","C","O","C","O","C","C","O","N","C","N","C","C","C","N","N","C","N",None,"H","H","H","H","H","H","H","H","H","H","H"),#A
    ("O","P","O","O","C","C","O","C","O","C","C","O","N","C","O","N","C","N","C","C",None,None,None,"H","H","H","H","H","H","H","H","H","H","H"),#C
    ("O","P","O","O","C","C","O","C","O","C","C","O","N","C","N","N","C","C","C","O","N","C","N","H","H","H","H","H","H","H","H","H","H","H"),#G
    ("O","P","O","O","C","C","O","C","O","C","C","O","N","C","O","N","C","O","C","C",None,None,None,"H","H","H","H","H","H","H","H","H","H",None),#U
    ("O","P","O","O","C","C","O","C","O","C","C","O",None,None,None,None,None,None,None,None,None,None,None,"H","H","H","H","H","H","H","H",None,None),#RX
]

# tip atom
aa2tip = [
        " N1 ", # A
        " N3 ", # C
        " N1 ", # G
        " N3 ", # U
        " C1'", # RX
        ]

# ideal OP1,P,OP2 initial coordinates (nucleic acid)
init_OP1 = torch.tensor([-0.7319, 1.2920, 0.000]).float()
init_P = torch.zeros_like(init_OP1)
init_OP2 = torch.tensor([1.4855, 0.000, 0.000]).float()
INIT_NA_CRDS = torch.full((NTOTAL, 3), np.nan)
INIT_NA_CRDS[:3] = torch.stack((init_OP1, init_P, init_OP2), dim=0) # (3,3)

# non-backbone torsions
# (bb torsions are hard-coded)
torsions=[
    [ [" O4'"," C1'"," N9 "," C4 "], None, None, None  ],#A
    [ [" O4'"," C1'"," N1 "," C2 "], None, None, None  ],#C
    [ [" O4'"," C1'"," N9 "," C4 "], None, None, None  ],#G
    [ [" O4'"," C1'"," N1 "," C2 "], None, None, None  ],#U
    [ None, None, None, None ],  # RX
]

# frames for generic FAPE
frames=[
    [ [" OP1"," P  "," O5'"], [" P  "," O5'"," C5'"], [" O5'"," C5'"," C4'"], [" C5'"," C4'"," C3'"], [" C5'"," C4'"," O4'"], [" C4'"," O4'"," C1'"], [" C2'"," C1'"," N9 "], [" C4'"," C3'"," O3'"] ], #A
    [ [" OP1"," P  "," O5'"], [" P  "," O5'"," C5'"], [" O5'"," C5'"," C4'"], [" C5'"," C4'"," C3'"], [" C5'"," C4'"," O4'"], [" C4'"," O4'"," C1'"], [" C2'"," C1'"," N1 "], [" C4'"," C3'"," O3'"] ], #C
    [ [" OP1"," P  "," O5'"], [" P  "," O5'"," C5'"], [" O5'"," C5'"," C4'"], [" C5'"," C4'"," C3'"], [" C5'"," C4'"," O4'"], [" C4'"," O4'"," C1'"], [" C2'"," C1'"," N9 "], [" C4'"," C3'"," O3'"] ], #G
    [ [" OP1"," P  "," O5'"], [" P  "," O5'"," C5'"], [" O5'"," C5'"," C4'"], [" C5'"," C4'"," C3'"], [" C5'"," C4'"," O4'"], [" C4'"," O4'"," C1'"], [" C2'"," C1'"," N1 "], [" C4'"," C3'"," O3'"] ], #U
    [ [" OP1"," P  "," O5'"], [" P  "," O5'"," C5'"], [" O5'"," C5'"," C4'"], [" C5'"," C4'"," C3'"], [" C5'"," C4'"," O4'"], [" C4'"," O4'"," C1'"], [" C4'"," C3'"," O3'"] ], #RX
]
NFRAMES = max([len(f) for f in frames])

#fd Rosetta ideal coords
#fd   - uses same "frame-building" as AF2
# FRAMES:
#   base = 0
#   NA alpha/beta/gamma/delta = 1-4 (NA epsilon/zeta no frame)
#   NA nu2/nu1/nu0 = 5-7
#   chi_1(NA) = 8
ideal_coords = [
    [ # 27 A #0
        [" OP1", 0, (-0.7319, 1.2920, 0.000)],
        [" P  ", 0, (0.000, 0.000, 0.000)],
        [" OP2", 0, (1.4855, 0.000, 0.000)],
        [" O5'", 0, (-0.4948, -0.8559,  1.2489)],
        [" C5'", 1, (0.7289, 1.2185, 0.000)],
        [" C4'", 2, (0.5541, 1.4027, 0.000)],
        [" H5'", 2, (0.3201, -0.4698, -0.7986)],
        ["H5''", 2, (0.3206, -0.4706,  0.7970)],
        [" C3'", 3, ( 0.6673, 1.3669, 0.000)],
        [" H4'", 3, ( 0.3173, -0.5074,  0.7763)],
        [" O4'", 3, ( 0.4914, -0.6338, -1.2098)],
        [" C1'", 5, (0.4828, 1.3277, -0.0000)],
        [" H1'", 6, (0.3265, -0.4460, 0.8101)],
        [" N9 ", 6, (0.4722, -0.7339, -1.1894)],
        [" C2'", 6, (0.4641, 1.4573, 0.0000)],
        [" H2'", 7, (0.3582, -0.4393, -0.7998)],
        [" O2'", 7, (0.4613, -0.6189, 1.1921)],
        ["HO2'", 7, (0.2499, -1.5749, 1.1568)],
        [" O3'", 4, ( 0.5548,  1.3039, 0.000)],
        [" H3'", 4, ( 0.3215, -0.4857, -0.7888)],
		[" N1 ", 8, (2.7963, 2.8824, 0.0000)],
		[" C2 ", 8, (1.4955, 3.2007, 0.0000)],
		[" N3 ", 8, (0.4333, 2.3980, 0.0000)],
		[" C4 ", 8, (0.8127, 1.1078, 0.0000)],
		[" C5 ", 8, (2.1082, 0.6254, 0.0000)],
		[" C6 ", 8, (3.1432, 1.5774, 0.0000)],
		[" N6 ", 8, (4.4400, 1.2609, 0.0000)],
		[" N7 ", 8, (2.1146, -0.7630, 0.0000)],
		[" C8 ", 8, (0.8442, -1.0830, 0.0000)],
		[" H2 ", 8, (1.2972, 4.1608, 0.0000)],
		[" H61", 8, (5.1172, 1.9697, 0.0000)],
		[" H62", 8, (4.7154, 0.3206, 0.0000)],
		[" H8 ", 8, (0.5258, -2.0104, 0.0000)],
    ],

    [ # 28 C #1
        [" OP1", 0, (-0.7319, 1.2920, 0.000)],
        [" P  ", 0, (0.000, 0.000, 0.000)],
        [" OP2", 0, (1.4855, 0.000, 0.000)],
        [" O5'", 0, (-0.4948, -0.8559,  1.2489)],
        [" C5'", 1, (0.7289, 1.2185, 0.000)],
        [" C4'", 2, (0.5541, 1.4027, 0.000)],
        [" H5'", 2, (0.3201, -0.4698, -0.7986)],
        ["H5''", 2, (0.3206, -0.4706,  0.7970)],
        [" C3'", 3, ( 0.6673, 1.3669, 0.000)],
        [" H4'", 3, ( 0.3173, -0.5074,  0.7763)],
        [" O4'", 3, ( 0.4914, -0.6338, -1.2098)],
        [" C1'", 5, (0.4828, 1.3277, -0.0000)],
        [" H1'", 6, (0.3265, -0.4460, 0.8101)],
        [" N1 ", 6, (0.4722, -0.7339, -1.1894)],
        [" C2'", 6, (0.4641, 1.4573, 0.0000)],
        [" H2'", 7, (0.3582, -0.4393, -0.7998)],
        [" O2'", 7, (0.4613, -0.6189, 1.1921)],
        ["HO2'", 7, (0.2499, -1.5749, 1.1568)],
        [" O3'", 4, ( 0.5548,  1.3039, 0.000)],
        [" H3'", 4, ( 0.3215, -0.4857, -0.7888)],
        [" C2 ", 8, (0.6650, 1.2325, 0.0000)],
        [" O2 ", 8, (-0.0001, 2.2799, 0.0000)],
        [" N3 ", 8, (2.0175, 1.2603, 0.0000)],
        [" C4 ", 8, (2.7090, 0.1210, 0.0000)],
        [" N4 ", 8, (4.0423, 0.1969, 0.0000)],
        [" C5 ", 8, (2.0635, -1.1476, 0.0000)],
        [" C6 ", 8, (0.7250, -1.1627, 0.0000)],
        [" H42", 8, (4.5791, -0.6226, 0.0000)],
        [" H41", 8, (4.4833, 1.0723, 0.0000)],
        [" H5 ", 8, (2.5806, -1.9803, 0.0000)],
        [" H6 ", 8, (0.2622, -2.0258, 0.0000)],
    ],

    [ # 29 G #2
        [" OP1", 0, (-0.7319, 1.2920, 0.000)],
        [" P  ", 0, (0.000, 0.000, 0.000)],
        [" OP2", 0, (1.4855, 0.000, 0.000)],
        [" O5'", 0, (-0.4948, -0.8559,  1.2489)],
        [" C5'", 1, (0.7289, 1.2185, 0.000)],
        [" C4'", 2, (0.5541, 1.4027, 0.000)],
        [" H5'", 2, (0.3201, -0.4698, -0.7986)],
        ["H5''", 2, (0.3206, -0.4706,  0.7970)],
        [" C3'", 3, ( 0.6673, 1.3669, 0.000)],
        [" H4'", 3, ( 0.3173, -0.5074,  0.7763)],
        [" O4'", 3, ( 0.4914, -0.6338, -1.2098)],
        [" C1'", 5, (0.4828, 1.3277, -0.0000)],
        [" H1'", 6, (0.3265, -0.4460, 0.8101)],
        [" N9 ", 6, (0.4722, -0.7339, -1.1894)],
        [" C2'", 6, (0.4641, 1.4573, 0.0000)],
        [" H2'", 7, (0.3582, -0.4393, -0.7998)],
        [" O2'", 7, (0.4613, -0.6189, 1.1921)],
        ["HO2'", 7, (0.2499, -1.5749, 1.1568)],
        [" O3'", 4, ( 0.5548,  1.3039, 0.000)],
        [" H3'", 4, ( 0.3215, -0.4857, -0.7888)],
		[" N1 ", 8, (2.7458, 2.8461, 0.0000)],
		[" C2 ", 8, (1.4286, 3.2360, 0.0000)],
		[" N2 ", 8, (1.1989, 4.5575, 0.0000)],
		[" N3 ", 8, (0.4087, 2.3932, 0.0000)],
		[" C4 ", 8, (0.8167, 1.1068, 0.0000)],
		[" C5 ", 8, (2.1036, 0.6115, 0.0000)],
		[" C6 ", 8, (3.1883, 1.5266, 0.0000)],
		[" O6 ", 8, (4.4006, 1.2842, 0.0000)],
		[" N7 ", 8, (2.0980, -0.7759, 0.0000)],
		[" C8 ", 8, (0.8317, -1.0936, 0.0000)],
		[" H1 ", 8, (3.4279, 3.5496, 0.0000)],
		[" H22", 8, (0.2781, 4.8947, 0.0000)],
		[" H21", 8, (1.9487, 5.1879, 0.0000)],
		[" H8 ", 8, (0.5085, -2.0185, 0.0000)],
    ],
    [ # 30 U #3
        [" OP1", 0, (-0.7319, 1.2920, 0.000)],
        [" P  ", 0, (0.000, 0.000, 0.000)],
        [" OP2", 0, (1.4855, 0.000, 0.000)],
        [" O5'", 0, (-0.4948, -0.8559,  1.2489)],
        [" C5'", 1, (0.7289, 1.2185, 0.000)],
        [" C4'", 2, (0.5541, 1.4027, 0.000)],
        [" H5'", 2, (0.3201, -0.4698, -0.7986)],
        ["H5''", 2, (0.3206, -0.4706,  0.7970)],
        [" C3'", 3, ( 0.6673, 1.3669, 0.000)],
        [" H4'", 3, ( 0.3173, -0.5074,  0.7763)],
        [" O4'", 3, ( 0.4914, -0.6338, -1.2098)],
        [" C1'", 5, (0.4828, 1.3277, -0.0000)],
        [" H1'", 6, (0.3265, -0.4460, 0.8101)],
        [" N1 ", 6, (0.4722, -0.7339, -1.1894)],
        [" C2'", 6, (0.4641, 1.4573, 0.0000)],
        [" H2'", 7, (0.3582, -0.4393, -0.7998)],
        [" O2'", 7, (0.4613, -0.6189, 1.1921)],
        ["HO2'", 7, (0.2499, -1.5749, 1.1568)],
        [" O3'", 4, ( 0.5548,  1.3039, 0.000)],
        [" H3'", 4, ( 0.3215, -0.4857, -0.7888)],
		[" C2 ", 8, (0.6307, 1.2305, 0.0000)],
		[" O2 ", 8, (0.0260, 2.2886, 0.0000)],
		[" N3 ", 8, (2.0031, 1.1816, 0.0000)],
		[" C4 ", 8, (2.7953, 0.0532, 0.0000)],
		[" O4 ", 8, (4.0212, 0.1751, 0.0000)],
		[" C5 ", 8, (2.0746, -1.1833, 0.0000)],
		[" C6 ", 8, (0.7378, -1.1648, 0.0000)],
		[" H3 ", 8, (2.4701, 2.0428, 0.0000)],
		[" H5 ", 8, (2.5579, -2.0361, 0.0000)],
		[" H6 ", 8, (0.2681, -2.0239, 0.0000)],
    ],
    [ # 31 RX #4
        [" OP1", 0, (-0.7319, 1.2920, 0.000)],
        [" P  ", 0, (0.000, 0.000, 0.000)],
        [" OP2", 0, (1.4855, 0.000, 0.000)],
        [" O5'", 0, (-0.4948, -0.8559,  1.2489)],
        [" C5'", 1, (0.7289, 1.2185, 0.000)],
        [" C4'", 2, (0.5541, 1.4027, 0.000)],
        [" H5'", 2, (0.3201, -0.4698, -0.7986)],
        ["H5''", 2, (0.3206, -0.4706,  0.7970)],
        [" C3'", 3, ( 0.6673, 1.3669, 0.000)],
        [" H4'", 3, ( 0.3173, -0.5074,  0.7763)],
        [" O4'", 3, ( 0.4914, -0.6338, -1.2098)],
        [" C1'", 5, (0.4828, 1.3277, -0.0000)],
        [" H1'", 6, (0.3265, -0.4460, 0.8101)],
        [" C2'", 6, (0.4641, 1.4573, 0.0000)],
        [" H2'", 7, (0.3582, -0.4393, -0.7998)],
        [" O2'", 7, (0.4613, -0.6189, 1.1921)],
        ["HO2'", 7, (0.2499, -1.5749, 1.1568)],
        [" O3'", 4, ( 0.5548,  1.3039, 0.000)],
        [" H3'", 4, ( 0.3215, -0.4857, -0.7888)],
    ],
]
